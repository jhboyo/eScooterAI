# ==============================================================================
# YOLO 모델 훈련 설정 파일 (train_config.yaml)
# ==============================================================================
#
# ## 이 파일이란?
# YOLO 모델 훈련에 필요한 하이퍼파라미터와 설정값을 정의하는 파일입니다.
# 모델 구조, 학습률, 배치 크기, 에포크 수 등 훈련 전반의 설정을 관리합니다.
#
# ## 언제 사용되나요?
# 1. 모델 훈련 시작 시:
#    python src/train.py --config configs/train_config.yaml
#
# 2. 훈련 스크립트에서 설정 로드:
#    with open('configs/train_config.yaml') as f:
#        config = yaml.safe_load(f)
#    model.train(
#        data='configs/ppe_dataset.yaml',
#        epochs=config['train']['epochs'],
#        batch=config['train']['batch_size'],
#        ...
#    )
#
# ## ppe_dataset.yaml과의 차이점
# - ppe_dataset.yaml: 데이터셋 위치와 클래스 정보 (YOLO 필수 파일)
# - train_config.yaml: 훈련 하이퍼파라미터 (사용자 정의 설정 파일)
#
# ## 주요 튜닝 포인트
# - epochs: 너무 적으면 학습 부족, 너무 많으면 과적합
# - batch_size: GPU 메모리에 따라 조절 (8, 16, 32, 64)
# - lr0: 학습률, 일반적으로 0.01에서 시작
# - img_size: 입력 이미지 크기, 클수록 정확하지만 느림
# ==============================================================================

# Model settings
# 사용할 YOLO 모델 버전 및 기본 설정
model:
  name: "yolov8n"  # 모델 크기: n(nano) < s(small) < m(medium) < l(large) < x(xlarge)
  pretrained: true  # COCO 사전학습 가중치 사용 (Transfer Learning)
  nc: 3  # 클래스 수: helmet, head, vest (3 Class)

# Dataset configuration
# 데이터셋 YAML 파일 경로 (상대 경로 권장)
data:
  yaml: "configs/ppe_dataset.yaml"

# Training parameters
# 모델 훈련에 사용되는 하이퍼파라미터
train:
  epochs: 100  # 전체 데이터셋 학습 반복 횟수
  batch_size: 128  # 한 번에 처리할 이미지 수 (GPU 메모리에 따라 조절), ex) 맥북 M3: 16
  img_size: 640  # 입력 이미지 크기 (가로/세로)
  patience: 20  # Early stopping: 성능 개선 없을 시 중단 기준
  workers: 8    # 데이터 로드 스레드 수

  # Optimizer settings
  # 최적화 알고리즘 및 학습률 설정
  optimizer: "AdamW"  # 옵티마이저: SGD, Adam, AdamW
  lr0: 0.01  # 초기 학습률
  lrf: 0.01  # 최종 학습률 (lr0 * lrf = 0.0001)
  momentum: 0.937  # SGD/Adam momentum
  weight_decay: 0.0005  # L2 정규화 가중치
  warmup_epochs: 3.0  # 학습률 워밍업 에포크
  warmup_momentum: 0.8  # 워밍업 시 momentum
  warmup_bias_lr: 0.1  # 워밍업 시 bias 학습률

# Data augmentation
# 데이터 증강 설정 (과적합 방지, 일반화 성능 향상)
augment:
  hsv_h: 0.015  # 색조(Hue) 변화
  hsv_s: 0.7  # 채도(Saturation) 변화
  hsv_v: 0.4  # 명도(Value) 변화
  degrees: 0.0  # 회전 각도
  translate: 0.1  # 이동 비율
  scale: 0.5  # 스케일 변화
  shear: 0.0  # 전단 변환
  flipud: 0.0  # 상하 반전 확률
  fliplr: 0.5  # 좌우 반전 확률
  mosaic: 1.0  # 모자이크 증강 확률
  mixup: 0.0  # Mixup 증강 확률

# Output settings
# 결과물 저장 위치 및 이름
output:
  save_dir: "models"  # 모델 저장 디렉토리
  name: "ppe_detection"  # 실험 이름 (models/ppe_detection/)
  exist_ok: true  # 기존 결과 덮어쓰기 허용 여부

# Device settings
# GPU/CPU 설정
device: ""  # 자동 감지, 또는 지정: "0", "0,1", "cpu"

# Logging and saving
# 로깅 및 체크포인트 설정
verbose: true  # 상세 로그 출력
save_period: -1  # 체크포인트 저장 주기 (-1: 비활성화)
